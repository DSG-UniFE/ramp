# DIGITAL TWIN - SDN Controller Client TESTBED

The following code has been developed for the "Digital Twin Management in Industrial Edge Environments" paper submission.

The testbed simulates the communication between two clients by means of an intermediary node. The sender and the receiver do not communicate directly each other so a Controller is in charge of coordinate their communication by easing the discovery process of a possible route.

<p align="center">
  <img src="http://mattestorage.it/dt/digital_twin.jpg"/>
</p>

## Testbed description

### Basic comminication
The sender (S) sends starts an handhshake protocol with the receiver (R) to set the outgoing application routing.
S sends 150 packets per seconds for 10 seconds, at that stage the network is not congested.
S sends to R three different types of packets:
* Info packets: logs generated by the conveyor, the assembler,
* Video packets: carrying frames provided by surveillance cameras, 
* Vibration packets: representing the data provided by the drill.

### First traffic spike
The sender (S) starts sending at 650 pkt/s and in less than 1 second the network is congested, packets arrive to the sender with about 250 ms of latency.
The node in the middle (M) detects the congestion and notifies the controller which sends to S a "LowLatency rule" that has to be applied. This is a Java 8 serialized class which leads to a drop of 15% of the pkts and a delay to specific packet types (eg. video and vibration). The network is congested but the application of the LowLatency rule leads to a better state, the latency drops from 200ms to about 100ms.

### Second traffic spike
The sender (S) starts sending at 1050 pkt/s and in 4 seconds the network is congested again, packets arrive to the sender with about 300 ms of latency.
The node in the middle (M) detects the congestion and notifies the controller which sends to S a "MediumCongestion rule" that has to be applied. This leads to a drop of 25% of the pkts, the daly applied to specific packet types (eg. video and vibration) is higher. The application of the MediumLatency rule reduces the latency to 250ms.

### Third traffic spike
The sender (S) starts sending at 1650 pkt/s and in 4 seconds the network is congested for the last time, packets arrive to the sender with about 450 ms of latency.
The node in the middle (M) detects the congestion and notifies the controller which sends to S a "HighCongestion rule" that has to be applied. Packets are not dropped anymore in order to do not lose knowledge about the network, so the controller helps S and R to establish a os route. Packets are now arriving to R with a latency of about 20ms.
The drowback is that packets are not wrapped at the application level anymore, so no other network adjustements can be made at the application level.

The graph below shows the relation between the simulation time and the corresponding latencies while indicating the how external metrics are changed.

<p align="center">
  <img src="http://mattestorage.it/dt/graph.png" alt="RAMP scenario"/>
</p>
